{% extends 'store/base.html' %}
{% load static %}
{% block css %}
	<link rel="stylesheet" type="text/css" href="{% static 'css/product.css' %}">
	<style>
		#navbar-container {
			border-bottom: 1px solid #b5b2c8;
		}
		
		#navbar-right li p,
		#navbar-bottom li a,
		#navbar-login li a,
		#navbar li a {
			color: #000;
		} 
	</style>
{% endblock css %}
{% block content %}
	<section class="section-p1">
		<div id="container">
  			<div class="small-img-group">
  				{% for image in images %}
	  				<div class="small-img-row">
	  					<img src="{{ image.imageURL }}" data-index="{{ forloop.counter0 }}" onclick="changeMainImage(event)">
	  				</div>
  				{% endfor %}
  			</div>
  			<div class="image_container">
  				<div id="product_image" class="main-image">
    				<!-- <img src="{{ product.imageURL }}"> -->
    				<img src="{{ images.0.imageURL }}" id="mainImage">
    			</div>
  			</div>
  			

  			<div class="product-details">
    			<h2>{{ product.name }}</h2>
    			<div class="rating">
					<div class="star">
						<i class="fas fa-star"></i>
						<i class="fas fa-star"></i>
						<i class="fas fa-star"></i>
						<i class="fas fa-star"></i>
						<i class="fas fa-star"></i>
					</div>
					<p class="review-number">{{ reviews.count }}</p>  
					<span> reviews</span>
				</div>
				<span>Sold Out</span>
				<div class="price-box">
					<span class="crossed-price">${{ product.crossed_out_price }}</span>
					<span class="price">${{ product.price }}</span>
					<span class="save">Save {{ product.calc_save }}%</span>
				</div>

				<div class="prospect">
					<p>Free Worldwide Shipping</p>
					<p>Easy Returns & Exchanges</p>
					<p>Fast, Friendly Support</p>
					<p>In stock, ready to ship</p>
					{% for variant in variants %}
						{% if variant.color %}
							{% if forloop.counter == 1 %}
								<h4>COLOR</h4>
							{% endif %}
							<button>{{ variant.color }}</button>
						{% endif %}
					{% endfor %}

					{% for variant in variants %}
						{% if variant.size %}
							{% if forloop.counter == 1 %}
								<h4>SIZE</h4>
							{% endif %}
							<button>{{ variant.size }}</button>
						{% endif %}
					{% endfor %}

					<!-- <h4>QUANTITY</h4>
					<input type="number" value="1">

					<div class="add-to-cart">
						<button><a href="#">ADD TO CART</a></button>
					</div> -->
					{% if product.available %}
						<div class="form-wrapper">
							<form method="POST" action="{% url 'product' product.slug %}">
							{% csrf_token %}
							<input min="1" value="1" type="number" name="quantity">
							<input class="add-to-cart-button" type="submit" value="Add to Cart">
							</form>
					  	</div>
					{% endif %}
				</div>
				<div class="description">
					<p>{{ product.description|safe }}</p>
				</div>
			</div>
		</div>

	</section>
	<section class="section-p1">
		<div class="reviews-container">
			{% for review in reviews %}
				<div class="review-row">
					<p>{{ review.text }}</p>
					<p>{{ review.name }}</p>
					<div class="star">
						{% for star in "x"|ljust:review.rating %}
							<i class="fas fa-star"></i>
						{% endfor %}
					</div>
					<div class="review-images">
						{% for image in review.reviewimage_set.all %}
							<img src="{{ image.imageURL}}">
						{% endfor %}
					</div>
				</div>
			{% endfor %}
		</div>
	</section>
	<script>
	    // Функція для зміни головного зображення при кліку на маленьку картинку
	    function changeMainImage(event) {
	        // Отримати URL зображення з атрибуту src маленької картинки
	        var imageURL = event.target.src;

	        // Отримати індекс елемента в списку images з атрибуту data-index
	        var index = event.target.getAttribute("data-index");

	        // Змінити src головного зображення на вибране зображення
	        document.getElementById("mainImage").src = imageURL;
	    }
	</script>
{% endblock content %}
